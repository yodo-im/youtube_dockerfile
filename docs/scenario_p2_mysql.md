`` ``` ```
## Dockerfile. Часть 2
# Контейнер с подготовленной БД mysql

1. Заходим в официальную документацию к официальному докер образу Mysql. Mysql - довольно самодостаточный образ. Здесь написано как запускать контрейнер прямо из него, для этого нужно только указать переменную окружения - пароль для суперпользователя. Но нам этого будет недостаточно.
В создадим собственный образ, в нём будут:
- пароль для суперпользователя, переменная окружения MYSQL_ROOT_PASSWORD
- новая база данных, переменная окружения MYSQL_DATABASE
- база будет заполнена начальными данными, для этого создадим sql скрипте

2. Подготовим данные для загрузки. Для этого создадим в корневой директории проекта папку `db_init` и в ней создадим файл `domain.sql`. В файле `domain.sql` запишем:
```
CREATE TABLE IF NOT EXISTS domain (id INT AUTO_INCREMENT PRIMARY KEY, value CHAR(250));

INSERT INTO domain (value) VALUES('facebook.com'), ('instagram.com');
INSERT INTO domain (value) VALUES('yodo.im'),('linkedin.com');
```
Для того чтобы данные загрузились в БД мы должны поместить этот файл в образ в директорию `/docker-entrypoint-initdb.d.` Сведения об этом находятся разделе *Initializing a fresh instance* документации. Файлы определённых форматов в этой директории исполняются автоматически при запуске контейнера из этого образа. Так определено разработчиками образа mysql.

3. Cоздадим в корневой директории проекта файл `Dockerfile.db` и пишем:
```
FROM mysql

COPY ./db_init /docker-entrypoint-initdb.d

ENV MYSQL_ROOT_PASSWORD=777
ENV MYSQL_DATABASE=check-domain
```

4. Собираем образ. В консоли на рабочей машине заходим в корневую директорию нашего проекта и пишем команду для сборки образа `docker build -t cd_db_img1 -f db.Dockerfile .`

5. Запускаем контейнер `docker run -p 3306:3306 cd_db_img1`, -p 3306:3306 - означает открыть стандартный порт на внешний мир. Теперь мы можем подключиться к БД из хоста, если конечно есть установленный mysql клиент. Если нет, можно зайти через контейнер.

6. Проверяем заполнилась ли БД.
```
show database;
use database;
select * from domain;
```
